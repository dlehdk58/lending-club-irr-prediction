# 📊 Lending Club 신용평가 및 수익률 극대화 모델

## 📌 프로젝트 개요
Lending Club은 대출 신청자와 투자자를 직접 연결하는 **P2P 금융 플랫폼**입니다.  
본 프로젝트의 목표는 **Sharpe Ratio 최대화**를 통해 투자자의 위험 대비 수익을 극대화하는 것입니다.

---

## 📂 데이터 & 전처리
- **변수 선택 원칙**: 대출 신청 시점에 알 수 있는 변수만 사용  
  예: `loan_amnt`, `dti`, `annual_inc`, `term`, `purpose`, `addr_state` 등
- **전처리 과정**:
  - 극단값 cap
  - 구간화(binning)
  - 결측치 대체(0, 평균, 중앙값)
  - 로그 변환
  - One-hot Encoding
  - 스케일링(Min-Max, Standard)
  - 사후변수 제거

---

## ⚙️ 모델링 파이프라인 (3단계)

### 1) **분류 모델** — 부도 여부 예측
- 신청 시점 변수로 **부도 확률(PD)** 예측  
- 부도 위험이 높은 대출을 사전 필터링

### 2) **회귀 모델** — IRR(수익률) 예측
- 각 대출의 **예상 IRR** 추정  
- 주요 변수:
  - `mths_since_rcnt_il_unknown` (최근 대출 관련 정보 부재)
  - `dti` ↑ → IRR ↓
  - `acc_open_past_24mths` ↑ → IRR ↑

### 3) **Sharpe 최적화 & 포트폴리오 구성**
- 승인/거절 임계값을 조정하며 **Sharpe Ratio** 계산
- **Sharpe Ratio 공식**:
  \[
  Sharpe = \frac{E[R - R_f]}{\sigma(R - R_f)}
  \]
  - \( R \): 투자 수익률
  - \( R_f \): 무위험 수익률(국채금리)
  - \( \sigma \): 초과수익률의 표준편차
- 부트스트랩으로 Sharpe 분포 추정 → 최적 임계값 선택
- **부도 처리 로직**:
  - `pred = 대출` & `actual = 부도` → IRR을 0으로 처리  
  - 단, 실제 상환이 일부 이루어진 부도 건은 **음수 IRR**로 계산되어 반영됨  
    (상환액이 원금보다 적어 현금흐름이 순손실이 되기 때문)

---

## 📈 IRR 계산식
- IRR(Internal Rate of Return)은 투자로부터 발생하는 현금흐름의 현재가치가 0이 되는 할인율입니다.
- 수식:
  0 = Σ [ C_t / (1 + IRR)^t ],  t = 0 ... T  
  - C₀: 초기 투자금(대출 실행금액, 음수)  
  - C_t: t시점의 순현금흐름  
  - T: 총 기간(월 단위)
- **부도 시 IRR이 음수인 이유**:
  - 원금 회수가 불완전하여 총 회수금액이 투자원금보다 작음
  - 이 경우 할인율이 음수가 되어, 손실 투자로 평가됨

---

## 📊 주요 결과
- **CatBoost(분류)**: Sharpe ≈ **0.139** → 안정적 수익 가능성
- **XGBoost(회귀 + 결정단)**: Sharpe ≈ **0.1985** → 위험 대비 수익률 최적
- XGBoost 회귀모델의 영향력 큰 변수:
  - `mths_since_rcnt_il_unknown`
  - `dti` (총부채비율)
  - `acc_open_past_24mths`

---

## ⚠️ 한계 & 제외 사항
- **공동대출(Co-borrower)**:
  - 주·부대출자 간 소득·재산 차이, 대출 목적 차이(주택·가정), 금액 규모 차이를 정량 반영하기 어려움  
  - 이번 분석에서는 제외
- **발행 시점 한계**:
  - `issue_d`가 월 단위만 제공되어 **국채 금리와 정확한 일자 매칭 불가**
- **IRR 계산 제약**:
  - 월별 상환 시점·금액 세부 데이터 부재
  - 현실적인 IRR 계산이 아닌 이상적인 가정 기반 계산에 의존

---

## 🚀 향후 과제
- 공동대출 특성(주·부대출자 속성, 대출 목적, 금액) 반영 방법 설계
- 일 단위 발행일 확보 또는 추정으로 금리 매칭 정밀화
- 월별 상세 상환 데이터 확보로 현실적 IRR 및 Sharpe 계산 고도화

---

## 🛠 기술 스택
- Python
- Pandas, NumPy, Scikit-learn
- XGBoost, CatBoost
- Matplotlib, Seaborn

---
